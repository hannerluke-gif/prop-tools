// ============================================================
// GUIDE PAGES COMPONENT
// Strict BEM structure for reusable guide/landing page layouts
// All guide pages use this component for consistent styling
// ============================================================
.guide {
  // ============================================================
  // HEADER SECTION
  // ============================================================
  &__header {
    margin-bottom: $guide-content-spacing;
  }
  &__title {
    // Big & Soft styling - responsive sizing with modern semi-bold weight
    font-size: $guide-title-size-mobile;
    font-weight: $guide-title-font-weight;
    letter-spacing: $guide-title-letter-spacing;
    color: $guide-title-color;
    
    // Desktop responsive sizing: clamp for smooth scaling between min/max
    @media (min-width: 768px) {
      font-size: clamp(#{$guide-title-size-desktop-min}, 4vw, #{$guide-title-size-desktop-max});
    }
  }
  &__subtitle {
    // Enhanced readability with muted appearance and optimal line length
    font-size: $guide-subtitle-size-mobile;
    font-weight: $guide-subtitle-font-weight;
    line-height: $guide-subtitle-line-height-mobile;
    color: $guide-subtitle-color;
    max-width: $guide-subtitle-max-width;
    
    // Desktop responsive sizing and line-height
    @media (min-width: 768px) {
      font-size: $guide-subtitle-size-desktop;
      line-height: $guide-subtitle-line-height-desktop;
    }
  }
  // ============================================================
  // CONTENT SECTIONS
  // ============================================================
  &__section {
    margin-top: $guide-section-spacing;
    &:first-of-type {
      margin-top: 0;
    }
  }
  &__section-title {
    // Strong second-tier hierarchy - clearly below title but prominent
    font-size: $guide-section-title-size-mobile;
    font-weight: $guide-section-title-font-weight;
    color: $guide-section-title-color;
    margin-top: $guide-section-title-margin-top;
    margin-bottom: $guide-section-title-margin-bottom;
    
    // Desktop responsive sizing
    @media (min-width: 768px) {
      font-size: $guide-section-title-size-desktop;
    }
  }
  // ============================================================
  // CONTENT LISTS
  // ============================================================
  &__steps {
    counter-reset: step;
    padding-left: 1rem;
    margin-bottom: $guide-content-spacing;
    
    > li {
      font-size: $guide-content-element-size;
      font-weight: $guide-content-element-font-weight;
      color: $guide-content-element-color;
      line-height: $guide-content-element-line-height;
      margin-bottom: 0.5rem;
    }
  }
  &__bullets {
    padding-left: 1.2rem;
    margin-bottom: $guide-content-spacing;
    
    > li {
      font-size: $guide-content-element-size;
      font-weight: $guide-content-element-font-weight;
      color: $guide-content-element-color;
      line-height: $guide-content-element-line-height;
      margin-bottom: 0.4rem;
    }
  }
  // ============================================================
  // CTA CARD COMPONENT
  // ============================================================
  &__cta {
    background: $guide-cta-bg;
    border: 1px solid $guide-cta-border;
    border-radius: $guide-cta-border-radius;
    padding: $guide-cta-padding;
    margin: $guide-cta-spacing 0;
    
    &__title {
      font-size: $guide-cta-title-size;
      font-weight: $guide-cta-title-font-weight;
      color: $guide-cta-title-color;
      margin-bottom: $guide-cta-title-margin-bottom;
    }
    
    &__text {
      font-size: $guide-cta-text-size;
      font-weight: $guide-cta-text-font-weight;
      color: $guide-cta-text-color;
      line-height: $guide-cta-text-line-height;
      margin-bottom: $guide-cta-text-margin-bottom;
    }
  }
  // ============================================================
  // FAQ SECTION COMPONENT
  // ============================================================
  &__faq-section {
    // Double the default section spacing for clearer visual separation
    // This creates consistent breathing room between content and FAQ across all guides
    margin-top: $guide-section-spacing * 2;
  }
  &__faq {
    border-bottom: 1px solid $guide-faq-divider;
    padding: $guide-faq-padding 0;
    margin-bottom: $guide-faq-spacing;
    background: transparent;
    &__summary {
      cursor: pointer;
      font-size: $guide-faq-question-size;
      font-weight: $guide-faq-question-font-weight;
      color: $guide-faq-question-color;
      // Use guide system transition for consistent interactions
      transition: color $transition-duration ease;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      // If a heading is inside the summary, animate its color too for cohesion
      .h6 {
        font-size: inherit;
        font-weight: inherit;
        color: inherit;
        transition: color $transition-duration ease;
      }
      // Remove default marker
      &::marker {
        content: "";
      }
      // Add disclosure arrow
      &::before {
        content: "â–¶";
        font-size: 0.75rem;
        // Use consistent guide transition duration for both transform and color
        transition: transform $transition-duration ease, color $transition-duration ease;
        flex-shrink: 0;
      }
      // Ensure links in the summary use guide system transitions
      a:not(.btn) {
        color: $text-color; // Use full white for FAQ summary links
        text-decoration: none;
        transition: color $transition-duration ease, text-decoration-color $transition-duration ease;
        
        &:hover,
        &:focus {
          color: $accent-cyan; // Use guide system accent color
          text-decoration: none;
          text-decoration-color: currentColor;
        }
        
        &:focus-visible {
          outline: 2px solid rgba($accent-cyan, 0.4);
          outline-offset: 2px;
        }
      }
      // Hover state - use refined FAQ question hover color
      &:hover {
        color: $guide-faq-question-hover-color;
        // Ensure child elements inherit the hover color
        .h6 {
          color: $guide-faq-question-hover-color;
        }
        &::before {
          color: $guide-faq-question-hover-color;
        }
      }
    }
    &__content {
      margin-top: 0.75rem;
      font-size: $guide-content-element-size;
      font-weight: $guide-content-element-font-weight;
      color: $guide-content-element-color;
      line-height: $guide-content-element-line-height;
    }
    // Ensure FAQ links always respect the guide system transition
    &__content a:not(.btn),
    &__summary a:not(.btn) {
      transition: color $transition-duration ease, text-decoration-color $transition-duration ease;
    }
    // Open state styling - maintain hover color when expanded
    &[open] &__summary {
      color: $guide-faq-question-hover-color;
      .h6 {
        color: $guide-faq-question-hover-color;
      }
      &::before {
        transform: rotate(90deg);
        color: $guide-faq-question-hover-color;
      }
    }
    &:last-of-type {
      margin-bottom: $guide-section-spacing;
    }
  }
  // ============================================================
  // KEEP LEARNING SECTION COMPONENT
  // ============================================================
  &__next {
    margin-top: $guide-next-spacing-top;
    &__title {
      // Match section title styling for consistency
      font-size: $guide-section-title-size-mobile;
      font-weight: $guide-section-title-font-weight;
      color: $guide-section-title-color;
      margin-top: $guide-section-title-margin-top;
      margin-bottom: $guide-section-title-margin-bottom;
      
      // Desktop responsive sizing
      @media (min-width: 768px) {
        font-size: $guide-section-title-size-desktop;
      }
    }
    &__list {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    &__item {
      margin-bottom: 0.75rem;
      &:last-child {
        margin-bottom: 0;
      }
    }
    &__link {
      font-size: $guide-content-element-size;
      font-weight: $guide-content-element-font-weight;
      color: $guide-content-element-color;
      line-height: $guide-content-element-line-height;
      text-decoration: $link-underline-default;
      text-decoration-color: $link-underline-color-default;
      transition: color $transition-duration ease, background-color $transition-duration ease, text-decoration-color $transition-duration ease;
      display: block;
      padding: $guide-next-link-padding;
      border-radius: $guide-next-link-radius;
      // Hover/focus states with cyan text color and visible underline for enhanced interactivity
      &:hover,
      &:focus {
        color: $guide-next-link-hover-color;
        background: $guide-next-link-hover-bg;
        text-decoration-color: $link-underline-color-hover;
        outline: none;
      }
    }
  }
  // ============================================================
  // BACK NAVIGATION COMPONENT
  // ============================================================
  &__back-nav {
    margin-bottom: 1rem;
  }
  &__back-nav-bottom {
    margin-top: 2rem;
    margin-bottom: 2rem;
  }
  &__back-link {
    // Subtle navigation styling - smaller and more muted than content elements
    font-size: $guide-back-nav-size;
    font-weight: $guide-back-nav-font-weight;
    color: $guide-back-nav-color;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 0.375rem; // Slightly more generous gap for better visual balance
    padding: 0.25rem 0.5rem; // Subtle padding for hover target
    border-radius: 0.25rem; // Small radius for hover background
    transition: color $transition-duration ease, background-color $transition-duration ease;
    
    &:hover,
    &:focus {
      color: $guide-back-nav-hover-color;
      text-decoration: none;
      outline: none;
    }
  }
  
  // ============================================================
  // UTILITY ELEMENTS
  // ============================================================
  &__divider {
    border-color: $guide-divider-color;
    opacity: 1;
    margin: 2.2rem 0;
  }
  &__disclosure {
    // Subdued fine print styling for legal/disclaimer text
    font-size: $guide-disclaimer-size;
    line-height: $guide-disclaimer-line-height;
    color: $guide-disclaimer-color;
    margin-top: $guide-content-spacing;
  }
  // ============================================================
  // UTILITY OVERRIDES
  // Minimal overrides for specific Bootstrap classes only
  // ============================================================
  .text-secondary.small {
    // Specific override for small secondary text in guides
    color: rgba(255, 255, 255, 0.5) !important;
  }
  hr {
    border-color: $guide-divider-color;
    opacity: 1;
  }
}

/* Guides Index */
.guide-index {
  .guide-index__groups {
    display: grid;
    gap: 1.25rem;
    grid-template-columns: 1fr;
    @media (min-width: 992px) { grid-template-columns: 1fr 1fr; }
  }
  .guide-index__group {
    background: rgba(255, 255, 255, 0.02);
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: 0.9rem;
    padding: 1rem 1.1rem;
  }
  .guide-index__heading { 
    // Use guide section title tokens for consistency with other guide pages
    font-size: $guide-section-title-size-mobile;
    font-weight: $guide-section-title-font-weight;
    color: $guide-section-title-color;
    margin-bottom: $guide-section-title-margin-bottom;
    
    // Desktop responsive sizing
    @media (min-width: 768px) {
      font-size: $guide-section-title-size-desktop;
    }
  }
  .guide-index__list { list-style: none; margin: 0; padding: 0; }
  .guide-index__item { margin: 0.25rem 0; }
  .guide-index__link {
    display: inline-flex; 
    align-items: center; 
    gap: 0.4rem;
    font-size: $guide-content-element-size;
    font-weight: $guide-content-element-font-weight;
    color: $guide-content-element-color;
    line-height: $guide-content-element-line-height;
    text-decoration: none;
    transition: color $transition-duration ease;
    
    &:hover,
    &:focus {
      color: $accent-cyan;
      outline: none;
      
      .guide-index__label {
        text-decoration: underline;
      }
    }
  }
  
  .guide-index__label {
    text-decoration: inherit;
  }
  
  // Ensure icons don't get underlined
  .guide-index__link .text-warning { 
    text-decoration: none !important;
  }
}