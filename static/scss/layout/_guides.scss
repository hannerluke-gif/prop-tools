// ============================================================
// GUIDE PAGES COMPONENT
// Strict BEM structure for reusable guide/landing page layouts
// All guide pages use this component for consistent styling
// ============================================================
.guide {
  color: $text-color;
  font-size: $guide-body-size;
  line-height: $guide-body-line-height;
  // Ensure all text elements inherit guide color unless specifically overridden
  *, *:before, *:after {
    color: inherit;
  }
  // ============================================================
  // HEADER SECTION
  // ============================================================
  &__header {
    margin-bottom: $guide-content-spacing;
  }
  &__title {
    font-weight: $weight-extrabold;
    letter-spacing: -0.01em;
  }
  &__subtitle {
    font-size: 1.15rem;
    line-height: 1.55;
  }
  // ============================================================
  // CONTENT SECTIONS
  // ============================================================
  &__section {
    margin-top: $guide-section-spacing;
    &:first-of-type {
      margin-top: 0;
    }
  }
  &__section-title {
    font-size: $guide-headline-size;
    font-weight: $weight-bold;
    margin-bottom: $guide-content-spacing;
  }
  // ============================================================
  // CONTENT LISTS
  // ============================================================
  &__steps {
    counter-reset: step;
    padding-left: 1rem;
    margin-bottom: $guide-content-spacing;
    > li {
      margin-bottom: 0.5rem;
    }
  }
  &__bullets {
    padding-left: 1.2rem;
    margin-bottom: $guide-content-spacing;
    > li {
      margin-bottom: 0.4rem;
    }
  }
  // ============================================================
  // CTA CARD COMPONENT
  // ============================================================
  &__cta {
    background: $guide-cta-bg;
    border: 1px solid $guide-cta-border;
    border-radius: 0.75rem;
    padding: 1.5rem;
    margin: $guide-cta-spacing 0;
    &__title {
      margin-bottom: 0.25rem;
    }
    &__text {
      margin-bottom: 0;
    }
  }
  // ============================================================
  // FAQ SECTION COMPONENT
  // ============================================================
  &__faq-section {
    // Double the default section spacing for clearer visual separation
    // This creates consistent breathing room between content and FAQ across all guides
    margin-top: $guide-section-spacing * 2;
    // Legacy modifier: kept for backwards compatibility but now redundant
    &--spacious {
      margin-top: $guide-section-spacing * 2;
    }
  }
  &__faq {
    border-bottom: 1px solid $guide-faq-divider;
    padding: $guide-faq-padding 0;
    margin-bottom: $guide-faq-spacing;
    background: transparent;
    &__summary {
      cursor: pointer;
      font-weight: $weight-semibold;
      // Use the same duration as text links so interactions feel consistent
      transition: color $text-link-transition-duration ease;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      // If a heading is inside the summary, animate its color too for cohesion
      .h6 {
        transition: color $text-link-transition-duration ease;
      }
      // Remove default marker
      &::marker {
        content: "";
      }
      // Add disclosure arrow
      &::before {
        content: "â–¶";
        font-size: 0.75rem;
        // Keep rotation quick but match link color transition duration for cohesion
        transition: transform 0.2s ease, color $text-link-transition-duration ease;
        flex-shrink: 0;
      }
      // Ensure links in the summary use the long, smooth alt link transition
      a:not(.btn) {
        @extend .text-link--alt;
      }
      // Hover state
      &:hover {
        // Do not set color on the whole summary; it overrides link transitions.
        // Instead, only target the heading and the arrow icon.
        --bs-heading-color: #{$guide-faq-hover-color};
        .h6 {
          color: $guide-faq-hover-color;
        }
        &::before {
          color: $guide-faq-hover-color;
        }
      }
    }
    &__content {
      margin-top: 0.75rem;
    }
    // Ensure FAQ links always respect the long text link transition
    &__content a:not(.btn),
    &__summary a:not(.btn) {
      transition: color $text-link-transition-duration ease, text-decoration-color $text-link-transition-duration ease !important;
    }
    // Open state styling
    &[open] &__summary {
      // Keep summary text color inherited to avoid fighting link transitions.
      --bs-heading-color: #{$guide-faq-hover-color};
      .h6 {
        color: $guide-faq-hover-color;
      }
      &::before {
        transform: rotate(90deg);
        color: $guide-faq-hover-color;
      }
    }
    &:last-of-type {
      margin-bottom: $guide-section-spacing;
    }
  }
  // ============================================================
  // KEEP LEARNING SECTION COMPONENT
  // ============================================================
  &__next {
    margin-top: $guide-next-spacing-top;
    &__title {
      font-weight: $weight-bold;
      font-size: $guide-headline-size;
      margin-bottom: $guide-next-spacing-bottom;
    }
    &__list {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    &__item {
      margin-bottom: 0.75rem;
      &:last-child {
        margin-bottom: 0;
      }
    }
    &__link {
      color: $text-link-color;
      text-decoration: $text-link-decoration;
      font-weight: $weight-regular;
      transition: color $text-link-transition-duration ease, background-color $text-link-transition-duration ease, text-decoration $text-link-transition-duration ease;
      display: block;
      padding: $guide-next-link-padding;
      border-radius: $guide-next-link-radius;
      // Default hover/focus states using Option 2 text link system
      &:hover,
      &:focus {
        color: $text-link-hover-color;
        text-decoration: $text-link-hover-decoration;
        background: $guide-next-link-hover-bg;
      }
      &:focus {
        outline: none;
      }
    }
  }
  // ============================================================
  // BACK NAVIGATION COMPONENT
  // ============================================================
  &__back-nav,
  &__back-nav-bottom {
    margin-bottom: 1rem;
  }
  &__back-nav-bottom {
    margin-top: 2rem;
    margin-bottom: 2rem;
  }
  &__back-link {
    color: $text-link-alt-color !important;
    font-weight: $weight-medium;
    font-size: 0.95rem;
    transition: color $text-link-transition-duration ease;
    display: inline-flex;
    align-items: center;
    gap: 0.3rem;
    
    &:hover,
    &:focus {
      color: $text-link-alt-hover-color !important;
      text-decoration: none !important;
    }
    
    &:focus {
      outline: none;
    }
  }
  
  // ============================================================
  // UTILITY ELEMENTS
  // ============================================================
  &__divider {
    border-color: $guide-divider-color;
    opacity: 1;
    margin: 2.2rem 0;
  }
  &__disclosure {
    color: rgba(255, 255, 255, 0.5) !important; // Intentionally override inherited color
    font-size: 0.82em;
    line-height: 1.4;
    margin-top: $guide-content-spacing;
  }
  // ============================================================
  // LEGACY SUPPORT
  // Support for existing markup patterns that don't use BEM structure
  // TODO: Remove once all guides use strict BEM naming conventions
  // ============================================================
  // Override Bootstrap text colors for guide context
  h1, h2, h3, h4, h5, h6,
  p,
  ul li,
  ol li {
    color: $text-color;
  }
  .text-secondary {
    color: $text-color !important;
    &.lead {
      color: $text-color !important;
    }
    // Special case: small secondary text should be muted
    &.small {
      color: rgba(255, 255, 255, 0.5) !important;
    }
  }
  hr {
    border-color: $guide-divider-color;
    opacity: 1;
  }
}

/* Guides Index */
.guide-index {
  .guide-index__groups {
    display: grid;
    gap: 1.25rem;
    grid-template-columns: 1fr;
    @media (min-width: 992px) { grid-template-columns: 1fr 1fr; }
  }
  .guide-index__group {
    background: rgba(255,255,255,.02);
    border: 1px solid rgba(255,255,255,.08);
    border-radius: .9rem;
    padding: 1rem 1.1rem;
  }
  .guide-index__heading { 
    margin-bottom: 1.25rem; 
    font-weight: $weight-bold;
    font-size: calc(1.3rem + 0.6vw);
    @media (min-width: 1200px) {
      font-size: 1.75rem;
    }
  }
  .guide-index__list { list-style: none; margin: 0; padding: 0; }
  .guide-index__item { margin: .25rem 0; }
  .guide-index__link {
    display: inline-flex; align-items: center; gap: .4rem;
    // Defer color/decoration to text-link utility classes (Option 3 via .text-link--accent)
    transition: color $text-link-transition-duration ease, text-decoration $text-link-transition-duration ease;
  }
  // Prevent underline being applied to the entire inline-flex (which would underline the icon)
  .guide-index__link { text-decoration: none; }
  .guide-index__label { text-decoration: inherit; }
  // Strengthen Option 3 inside guide index blocks if other global rules compete
  // Option 1 reinforcement (if needed): body color, no underline; cyan + underline on hover
  .guide-index__link.text-link { 
    color: $text-link-color; 
    text-decoration: none; 
    text-decoration-color: transparent;
  }
  // Apply underline on hover to label text only (Option 1)
  .guide-index__link.text-link:hover,
  .guide-index__link.text-link:focus,
  .guide-index__link.text-link:focus-visible,
  .guide-index__link.text-link:active { 
    color: $text-link-hover-color; 
    text-decoration: none !important; // hard override global .text-link:hover underline
    text-decoration-color: transparent !important;
  }
  .guide-index__link.text-link:hover .guide-index__label,
  .guide-index__link.text-link:focus .guide-index__label,
  .guide-index__link.text-link:focus-visible .guide-index__label,
  .guide-index__link.text-link:active .guide-index__label { text-decoration: $text-link-hover-decoration; }

  // Visited state: keep default/body color and no underline on the anchor
  .guide-index__link.text-link:visited {
    color: $text-link-color;
    text-decoration: none !important;
    text-decoration-color: transparent !important;
  }
  // Visited + interactive states: same as hover/focus (underline label only)
  .guide-index__link.text-link:visited:hover,
  .guide-index__link.text-link:visited:focus,
  .guide-index__link.text-link:visited:focus-visible,
  .guide-index__link.text-link:visited:active {
    color: $text-link-hover-color;
    text-decoration: none !important;
    text-decoration-color: transparent !important;
  }
  .guide-index__link.text-link:visited:hover .guide-index__label,
  .guide-index__link.text-link:visited:focus .guide-index__label,
  .guide-index__link.text-link:visited:focus-visible .guide-index__label,
  .guide-index__link.text-link:visited:active .guide-index__label {
    text-decoration: $text-link-hover-decoration;
  }

  // Ensure any icon next to the label (e.g., flame) never receives underline
  .guide-index__link .text-warning { text-decoration: none !important; }
  // No explicit :hover styles here; allow .text-link--accent to control hover underline/color
}



